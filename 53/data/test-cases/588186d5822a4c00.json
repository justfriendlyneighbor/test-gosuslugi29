{"uid":"588186d5822a4c00","name":"Тест Параметров по Подуслуге","fullName":"tests.test_target#test_target_details","historyId":"c41981a67c8381062aeafaa220e74745","time":{"start":1728703630966,"stop":1728703630966,"duration":0},"description":"Этот тест проверяет наличие на страницах подуслуг проверяемых параметров","descriptionHtml":"<p>Этот тест проверяет наличие на страницах подуслуг проверяемых параметров</p>\n","status":"broken","statusMessage":"AttributeError: 'NoneType' object has no attribute 'xpath'","statusTrace":"request = <SubRequest 'alltargetdetails' for <Function test_target_details>>\n\n    @pytest.fixture(scope='session')\n    def alltargetdetails(request):\n>       request.config.categories=get_targetdetails(request.config.targetpages)\n\ntests/test_target.py:176: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\npages = [{'service': ('24320@egClassification', '7538@egService', 'Неэлектронные услуги', {'12944@egServiceTarget': {'assert':...s', 'query': [{'key': 'id', 'value': '21128@egServiceTarget'}, {'key': 'serviceId', 'value': '7551@egService'}]}}, ...]\n\n    def get_targetdetails(pages):\n        categoryservicestargets={}\n        for page in pages:\n            category,service,variant,target=page['service']\n            asserts = []\n            details = {}\n            if categoryservicestargets.get(category)==None:\n                categoryservicestargets.update({category:{service:{variant:target}}})\n            elif categoryservicestargets[category].get(service)==None:\n                categoryservicestargets[category].update({service:{variant:target}})\n            elif categoryservicestargets[category][service].get(variant)==None:\n                categoryservicestargets[category][service].update({variant:target})\n            elif categoryservicestargets[category][service][variant].get(list(target.keys())[0])==None:\n                categoryservicestargets[category][service][variant].update(target)\n            soup = bs4.BeautifulSoup(page['text'], \"lxml\")\n            tree = lxml.etree.HTML(page['text'])\n            if variant=='Электронные услуги':\n                elements = Target.OnDetailsPageConfigElements\n            elif variant=='Неэлектронные услуги':\n                elements = Target.OffDetailsPageConfigElements\n            else:\n                elements = []\n            if len(elements) > 0:\n                for csselement in elements[\"css\"]:\n                    details[csselement[\"name\"]] = [(cssel.text if csselement[\"value\"] == \"text\" else cssel.attrs[csselement[\"value\"]]) for cssel in soup.select(csselement[\"elem\"])]\n                    asserts.append(len(details[csselement[\"name\"]]) != 0)\n                for xpathelement in elements[\"xpath\"]:\n>                   details[xpathelement[\"name\"]] = [(xpathel.text if xpathelement[\"value\"] == \"text\" else xpathel.attrib[xpathelement[\"value\"]]) for xpathel in tree.xpath(xpathelement[\"elem\"])]\nE                   AttributeError: 'NoneType' object has no attribute 'xpath'\n\ntests/test_target.py:168: AttributeError","flaky":true,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop_policy","time":{"start":1728703264336,"stop":1728703264336,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"alltargetdetails","time":{"start":1728703630967,"stop":1728703737883,"duration":106916},"status":"broken","statusMessage":"AttributeError: 'NoneType' object has no attribute 'xpath'\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/_pytest/setuponly.py\", line 36, in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/_pytest/fixtures.py\", line 1139, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/_pytest/fixtures.py\", line 897, in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/test-gosuslugi29/test-gosuslugi29/tests/test_target.py\", line 176, in alltargetdetails\n    request.config.categories=get_targetdetails(request.config.targetpages)\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/test-gosuslugi29/test-gosuslugi29/tests/test_target.py\", line 168, in get_targetdetails\n    details[xpathelement[\"name\"]] = [(xpathel.text if xpathelement[\"value\"] == \"text\" else xpathel.attrib[xpathelement[\"value\"]]) for xpathel in tree.xpath(xpathelement[\"elem\"])]\n                                                                                                                                                 ^^^^^^^^^^\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"afterStages":[],"labels":[{"name":"severity","value":"normal"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_target"},{"name":"host","value":"fv-az1200-127"},{"name":"thread","value":"2162-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_target"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":5,"broken":1,"skipped":0,"passed":1,"unknown":0,"total":7},"items":[{"uid":"1df6680d9d2ebbda","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/52//#testresult/1df6680d9d2ebbda","status":"failed","statusDetails":"AssertionError: На странице 12944@egServiceTarget не соответствуют пункты: ('Основание для приостановления/отказа',)\nassert False","time":{"start":1728640000515,"stop":1728640007947,"duration":7432}},{"uid":"c26f2f3816a5e582","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/49//#testresult/c26f2f3816a5e582","status":"failed","statusDetails":"AssertionError: На странице 12944@egServiceTarget не соответствуют пункты: ('Основание для приостановления/отказа',)\nassert False","time":{"start":1728631375758,"stop":1728631383182,"duration":7424}},{"uid":"8cf2b2f634595161","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/48//#testresult/8cf2b2f634595161","status":"failed","statusDetails":"AssertionError: На странице 12944@egServiceTarget не соответствуют пункты: ('Основание для приостановления/отказа',)\nassert False","time":{"start":1728629327058,"stop":1728629328961,"duration":1903}},{"uid":"1ceb312da11ee555","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/47//#testresult/1ceb312da11ee555","status":"passed","time":{"start":1728628306405,"stop":1728628306405,"duration":0}},{"uid":"d17bf4e3df0fa584","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/46//#testresult/d17bf4e3df0fa584","status":"failed","statusDetails":"AssertionError: На странице 12944@egServiceTarget не соответствуют пункты: ('Основание для приостановления/отказа',)\nassert False","time":{"start":1728617541499,"stop":1728617543373,"duration":1874}},{"uid":"dba75c7a5f34b543","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/45//#testresult/dba75c7a5f34b543","status":"failed","statusDetails":"AssertionError: На странице 12944@egServiceTarget не соответствуют пункты: ('Основание для приостановления/отказа',)\nassert False","time":{"start":1728570640819,"stop":1728570642741,"duration":1922}}]},"tags":[]},"source":"588186d5822a4c00.json","parameterValues":[]}