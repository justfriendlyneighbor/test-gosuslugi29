{"uid":"2efd426e414bacd2","name":"Тест доступности Подуслуг по Услуге","fullName":"tests.test_service#test_service_pages","historyId":"4640de6902f221b70caa7f772a048086","time":{"start":1730086546689,"stop":1730086546689,"duration":0},"description":"Этот тест проверяет доступность страниц услуг","descriptionHtml":"<p>Этот тест проверяет доступность страниц услуг</p>\n","status":"broken","statusMessage":"aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host gosuslugi29.ru:443 ssl:False [Connect call failed ('77.83.151.43', 443)]","statusTrace":"self = <aiohttp.connector.TCPConnector object at 0x7f0370329150>\nreq = <aiohttp.client_reqrep.ClientRequest object at 0x7f03697960d0>\ntimeout = ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None)\nclient_error = <class 'aiohttp.client_exceptions.ClientConnectorError'>\nargs = (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=False closed=False debug=False>), '77.83.151.43', 443)\nkwargs = {'family': <AddressFamily.AF_INET: 2>, 'flags': <AddressInfo.AI_NUMERICHOST|AI_NUMERICSERV: 1028>, 'local_addr': None, 'proto': 6, ...}\n\n    async def _wrap_create_connection(\n        self,\n        *args: Any,\n        req: \"ClientRequest\",\n        timeout: \"ClientTimeout\",\n        client_error: Type[Exception] = ClientConnectorError,\n        **kwargs: Any,\n    ) -> Tuple[asyncio.Transport, ResponseHandler]:\n        try:\n            async with ceil_timeout(timeout.sock_connect):\n>               return await self._loop.create_connection(*args, **kwargs)  # type: ignore[return-value]  # noqa\n\n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py:980: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/asyncio/base_events.py:1086: in create_connection\n    raise exceptions[0]\n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/asyncio/base_events.py:1070: in create_connection\n    sock = await self._connect_sock(\n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/asyncio/base_events.py:974: in _connect_sock\n    await self.sock_connect(sock, address)\n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/asyncio/selector_events.py:638: in sock_connect\n    return await fut\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <_UnixSelectorEventLoop running=False closed=False debug=False>\nfut = None, sock = <socket.socket [closed] fd=-1, family=2, type=1, proto=6>\naddress = ('77.83.151.43', 443)\n\n    def _sock_connect_cb(self, fut, sock, address):\n        if fut.done():\n            return\n    \n        try:\n            err = sock.getsockopt(socket.SOL_SOCKET, socket.SO_ERROR)\n            if err != 0:\n                # Jump to any except clause below.\n>               raise OSError(err, f'Connect call failed {address}')\nE               ConnectionRefusedError: [Errno 111] Connect call failed ('77.83.151.43', 443)\n\n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/asyncio/selector_events.py:678: ConnectionRefusedError\n\nThe above exception was the direct cause of the following exception:\n\nrequest = <SubRequest 'service_pages' for <Function test_service_pages>>\n\n    @pytest.fixture(scope=\"session\")\n    async def service_pages(request):\n        pages = {}\n        async with aiohttp.ClientSession() as session:\n>           pages = await get_service_pages(session, request.config.categories)\n\ntests/test_service.py:69: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/test_service.py:39: in get_service_pages\n    await responses\nutils/utils.py:58: in fetch_url\n    async with session.request(**req, url=buildurl(**UrlPart)) as response:\n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/client.py:536: in _request\n    conn = await self._connector.connect(\n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py:540: in connect\n    proto = await self._create_connection(req, traces, timeout)\n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py:901: in _create_connection\n    _, proto = await self._create_direct_connection(req, traces, timeout)\n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py:1209: in _create_direct_connection\n    raise last_exc\n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py:1178: in _create_direct_connection\n    transp, proto = await self._wrap_create_connection(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <aiohttp.connector.TCPConnector object at 0x7f0370329150>\nreq = <aiohttp.client_reqrep.ClientRequest object at 0x7f03697960d0>\ntimeout = ClientTimeout(total=300, connect=None, sock_read=None, sock_connect=None)\nclient_error = <class 'aiohttp.client_exceptions.ClientConnectorError'>\nargs = (functools.partial(<class 'aiohttp.client_proto.ResponseHandler'>, loop=<_UnixSelectorEventLoop running=False closed=False debug=False>), '77.83.151.43', 443)\nkwargs = {'family': <AddressFamily.AF_INET: 2>, 'flags': <AddressInfo.AI_NUMERICHOST|AI_NUMERICSERV: 1028>, 'local_addr': None, 'proto': 6, ...}\n\n    async def _wrap_create_connection(\n        self,\n        *args: Any,\n        req: \"ClientRequest\",\n        timeout: \"ClientTimeout\",\n        client_error: Type[Exception] = ClientConnectorError,\n        **kwargs: Any,\n    ) -> Tuple[asyncio.Transport, ResponseHandler]:\n        try:\n            async with ceil_timeout(timeout.sock_connect):\n                return await self._loop.create_connection(*args, **kwargs)  # type: ignore[return-value]  # noqa\n        except cert_errors as exc:\n            raise ClientConnectorCertificateError(req.connection_key, exc) from exc\n        except ssl_errors as exc:\n            raise ClientConnectorSSLError(req.connection_key, exc) from exc\n        except OSError as exc:\n            if exc.errno is None and isinstance(exc, asyncio.TimeoutError):\n                raise\n>           raise client_error(req.connection_key, exc) from exc\nE           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host gosuslugi29.ru:443 ssl:False [Connect call failed ('77.83.151.43', 443)]\n\n/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py:988: ClientConnectorError","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop_policy","time":{"start":1730086220085,"stop":1730086220085,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false},{"name":"_session_event_loop","time":{"start":1730086221834,"stop":1730086221834,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false},{"name":"service_pages","time":{"start":1730086546689,"stop":1730086848617,"duration":301928},"status":"broken","statusMessage":"aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host gosuslugi29.ru:443 ssl:False [Connect call failed ('77.83.151.43', 443)]\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/_pytest/setuponly.py\", line 36, in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/_pytest/fixtures.py\", line 1139, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/_pytest/fixtures.py\", line 897, in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n                     ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/pytest_asyncio/plugin.py\", line 366, in _async_fixture_wrapper\n    return event_loop.run_until_complete(setup())\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/asyncio/base_events.py\", line 654, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/pytest_asyncio/plugin.py\", line 363, in setup\n    res = await func(**_add_kwargs(func, kwargs, event_loop, request))\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/test-gosuslugi29/test-gosuslugi29/tests/test_service.py\", line 69, in service_pages\n    pages = await get_service_pages(session, request.config.categories)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/test-gosuslugi29/test-gosuslugi29/tests/test_service.py\", line 39, in get_service_pages\n    await responses\n  File \"/home/runner/work/test-gosuslugi29/test-gosuslugi29/utils/utils.py\", line 58, in fetch_url\n    async with session.request(**req, url=buildurl(**UrlPart)) as response:\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/client.py\", line 536, in _request\n    conn = await self._connector.connect(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py\", line 540, in connect\n    proto = await self._create_connection(req, traces, timeout)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py\", line 901, in _create_connection\n    _, proto = await self._create_direct_connection(req, traces, timeout)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py\", line 1209, in _create_direct_connection\n    raise last_exc\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py\", line 1178, in _create_direct_connection\n    transp, proto = await self._wrap_create_connection(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py\", line 988, in _wrap_create_connection\n    raise client_error(req.connection_key, exc) from exc\n","steps":[{"name":"Асинхронно сделать 100 запросов с 0 по 100 к страницам категории 24320@egClassification","time":{"start":1730086546692,"stop":1730086821300,"duration":274608},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false},{"name":"Асинхронно сделать 100 запросов с 100 по 200 к страницам категории 24320@egClassification","time":{"start":1730086821300,"stop":1730086848444,"duration":27144},"status":"broken","statusMessage":"aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host gosuslugi29.ru:443 ssl:False [Connect call failed ('77.83.151.43', 443)]\n","statusTrace":"  File \"/home/runner/work/test-gosuslugi29/test-gosuslugi29/tests/test_service.py\", line 39, in get_service_pages\n    await responses\n  File \"/home/runner/work/test-gosuslugi29/test-gosuslugi29/utils/utils.py\", line 58, in fetch_url\n    async with session.request(**req, url=buildurl(**UrlPart)) as response:\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/client.py\", line 536, in _request\n    conn = await self._connector.connect(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py\", line 540, in connect\n    proto = await self._create_connection(req, traces, timeout)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py\", line 901, in _create_connection\n    _, proto = await self._create_direct_connection(req, traces, timeout)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py\", line 1209, in _create_direct_connection\n    raise last_exc\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py\", line 1178, in _create_direct_connection\n    transp, proto = await self._wrap_create_connection(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/aiohttp/connector.py\", line 988, in _wrap_create_connection\n    raise client_error(req.connection_key, exc) from exc\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false,"shouldDisplayMessage":true}],"attachments":[],"parameters":[],"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false,"shouldDisplayMessage":false},{"name":"check","time":{"start":1730086848779,"stop":1730086848779,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false}],"afterStages":[{"name":"_session_event_loop::0","time":{"start":1730086962331,"stop":1730086962331,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false}],"labels":[{"name":"severity","value":"blocker"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_service"},{"name":"host","value":"fv-az1108-610"},{"name":"thread","value":"2049-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_service"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"blocker","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":1,"skipped":17,"passed":5,"unknown":0,"total":23},"items":[{"uid":"d75abff5cc94a507","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/74//#testresult/d75abff5cc94a507","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1729839300789,"stop":1729839300838,"duration":49}},{"uid":"3be533692f1cc816","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/72//#testresult/3be533692f1cc816","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1729781339845,"stop":1729781339896,"duration":51}},{"uid":"28d5bb1295a652f7","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/71//#testresult/28d5bb1295a652f7","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1729779574306,"stop":1729779574358,"duration":52}},{"uid":"f787c1da2e8a246f","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/70//#testresult/f787c1da2e8a246f","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1729778374574,"stop":1729778374625,"duration":51}},{"uid":"b9118aa4758f7d7e","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/64//#testresult/b9118aa4758f7d7e","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1729740470243,"stop":1729740470294,"duration":51}},{"uid":"fec38d7d170b200b","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/63//#testresult/fec38d7d170b200b","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1729481480091,"stop":1729481480143,"duration":52}},{"uid":"77176af04e063ef4","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/62//#testresult/77176af04e063ef4","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1729135672259,"stop":1729135672308,"duration":49}},{"uid":"7dbb980f9bc1654e","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/61//#testresult/7dbb980f9bc1654e","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1729078764765,"stop":1729078764816,"duration":51}},{"uid":"44f61b96444232a9","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/60//#testresult/44f61b96444232a9","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1729061562312,"stop":1729061562364,"duration":52}},{"uid":"ee8381bb0197c14","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/59//#testresult/ee8381bb0197c14","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1728917631938,"stop":1728917631989,"duration":51}},{"uid":"ee11c4e6709b77e2","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/58//#testresult/ee11c4e6709b77e2","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1728917172350,"stop":1728917172354,"duration":4}},{"uid":"a8d2a150bdf8f24d","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/57//#testresult/a8d2a150bdf8f24d","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1728913882685,"stop":1728913882735,"duration":50}},{"uid":"5e1d53c764ece01e","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/56//#testresult/5e1d53c764ece01e","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1728913485659,"stop":1728913485663,"duration":4}},{"uid":"4108e58ced159ed8","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/55//#testresult/4108e58ced159ed8","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1728876503172,"stop":1728876503210,"duration":38}},{"uid":"d74b3f4d11521445","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/54//#testresult/d74b3f4d11521445","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1728790030971,"stop":1728790031005,"duration":34}},{"uid":"9d53d9d6f1ca9669","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/53//#testresult/9d53d9d6f1ca9669","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1728703371421,"stop":1728703371456,"duration":35}},{"uid":"2ec357f80e5c1f47","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/52//#testresult/2ec357f80e5c1f47","status":"skipped","statusDetails":"Skipped: Completed succesfully, skipping from report","time":{"start":1728639549850,"stop":1728639549886,"duration":36}},{"uid":"4450e96ec883e8a3","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/49//#testresult/4450e96ec883e8a3","status":"passed","time":{"start":1728630918875,"stop":1728630919983,"duration":1108}},{"uid":"8cf98c37b53d55e8","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/48//#testresult/8cf98c37b53d55e8","status":"passed","time":{"start":1728628826403,"stop":1728628827326,"duration":923}},{"uid":"22abd4b199ee8c13","reportUrl":"https://justfriendlyneighbor.github.io/test-gosuslugi29/47//#testresult/22abd4b199ee8c13","status":"passed","time":{"start":1728628303724,"stop":1728628303724,"duration":0}}]},"tags":[]},"source":"2efd426e414bacd2.json","parameterValues":[]}